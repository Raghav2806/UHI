<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous" />
  <link rel="stylesheet" href="/styles/main.css" />
  <title>Form</title>
</head>
<body>
  <div class="contain">
    <form action="/prescription" class="row g-3 container my-4" method="post">
      <div class="col-md-6 form-floating">
        <input type="text" class="form-control" id="firstNameInput" placeholder="First Name" name="firstName" />
        <label for="firstNameInput">First Name</label>
      </div>
      <div class="col-md-6 form-floating">
        <input type="text" class="form-control" id="lastNameInput" placeholder="Last Name" name="lastName" />
        <label for="lastNameInput">Last Name</label>
      </div>
      <div class="col-12 form-floating">
        <input type="text" class="form-control" id="addressOneInput" placeholder="1234 Main St" name="addressOne" />
        <label for="addressOneInput" class="form-label">Address</label>
      </div>
      <div class="col-12 form-floating">
        <input type="text" class="form-control" id="addressTwoInput" placeholder="Apartment, studio, or floor" name="addressTwo" />
        <label for="addressTwoInput" class="form-label">Address 2</label>
      </div>
      <div class="col-12 form-floating">
        <input type="text" class="form-control" id="cityInput" placeholder="City" name="city" />
        <label for="cityInput" class="form-label">City</label>
      </div>
      <div class="col-12 form-floating">
        <input type="text" class="form-control" id="contactNumberInput" placeholder="Contact Number" name="contactNumber" />
        <label for="contactNumberInput" class="form-label">Contact Number</label>
      </div>
      <div class="col-md-4 form-floating">
        <input type="number" class="form-control" id="ageInput" placeholder="Age" name="age">
        <label for="ageInput" class="form-label">Age</label>
      </div>
      <div class="col-md-4">
        <select id="genderInput" class="form-select py-3" name="gender">
          <option selected>Choose your gender</option>
          <option value="Male">Male</option>
          <option value="Female">Female</option>
          <option value="Other">Other</option>
        </select>
      </div>
      <div class="col-md-4 form-floating">
        <input type="number" class="form-control" id="weightInput" placeholder="Weight" name="weight">
        <label for="weightInput" class="form-label">Weight</label>
      </div>
      <div class="col-md-8">
        <div class="form-group row">
          <div class="col-md-6">
            <select id="dynamicDropdown" class="form-select py-3" name="disease">
              <option selected>Choose an option</option>
            </select>
          </div>
          <div class="col-md-6" id="dynamicCheckboxContainer" name="medicines">
            <!-- Checkbox will be dynamically generated here -->
          </div>
        </div>
      </div>
      <input class="btn btn-primary" type="submit" value="Submit">
    </form>
  </div>
  <script>
    let inputData = {};
    <% if (input1) { %>
        inputData = <%- JSON.stringify(input1) %>;
    <% } %>
    console.log('inputData:', inputData);

    function populateDropdown() {
        const dropdown = document.getElementById('dynamicDropdown');
        const complaints = Object.keys(inputData);

        for (const complaint of complaints) {
            const option = document.createElement('option');
            option.value = complaint;
            option.textContent = complaint;
            dropdown.appendChild(option);
        }
    }

    function updateCheckboxes() {
        const dropdown = document.getElementById('dynamicDropdown');
        const checkboxContainer = document.getElementById('dynamicCheckboxContainer');
        checkboxContainer.innerHTML = ''; // Clear the container first

        const selectedOption = dropdown.options[dropdown.selectedIndex].value;
        if (selectedOption && inputData[selectedOption]) {
            const medicines = inputData[selectedOption];
            medicines.forEach(medicine => {
                const checkboxElement = document.createElement('div');
                checkboxElement.classList.add('form-check');

                const inputElement = document.createElement('input');
                inputElement.type = 'checkbox';
                inputElement.id = `medicine-${medicine}`;
                inputElement.name = 'medicines';
                inputElement.value = medicine;
                inputElement.classList.add('form-check-input');

                const labelElement = document.createElement('label');
                labelElement.htmlFor = `medicine-${medicine}`;
                labelElement.textContent = medicine;
                labelElement.classList.add('form-check-label');

                checkboxElement.appendChild(inputElement);
                checkboxElement.appendChild(labelElement);
                checkboxContainer.appendChild(checkboxElement);
            });
        }
    }

    window.onload = populateDropdown;
    const dropdown = document.getElementById('dynamicDropdown');
    dropdown.addEventListener('change', updateCheckboxes);
  </script>
</body>
</html>